import { utilService } from './util.service.js'
import { storageService } from './async-storage.service.js'
import axios from 'axios'

export const bitcoinService = {
    getRate,
    getMarketPriceHistory,
    getAvgBlockSize,
    getRateMap
}

async function getRate() {
    // const res = await axios.get('https://blockchain.info/tobtc?currency=USD&value=1')
    // return res.data
    // return await getDataFromAPI('https://blockchain.info/tobtc?currency=USD&value=1')
    return 0.00003324
}

async function getMarketPriceHistory() {
    // const res = await axios.get('https://api.blockchain.info/charts/market-price?timespan=5months&format=json&cors=true')
    // return res.data
    return {
        status: "ok",
        name: "Market Price (USD)",
        unit: "USD",
        period: "day",
        description: "Average USD market price across major bitcoin exchanges.",
        values: [
            {
                x: 1674432000,
                y: 22724.23
            },
            {
                x: 1674518400,
                y: 22924.37
            },
            {
                x: 1674604800,
                y: 22634.47
            },
            {
                x: 1674691200,
                y: 23089.74
            },
            {
                x: 1674777600,
                y: 23008.29
            },
            {
                x: 1674864000,
                y: 23075.81
            },
            {
                x: 1674950400,
                y: 23032.23
            },
            {
                x: 1675036800,
                y: 23755.85
            },
            {
                x: 1675123200,
                y: 22836.09
            },
            {
                x: 1675209600,
                y: 23133.91
            },
            {
                x: 1675296000,
                y: 23722.02
            },
            {
                x: 1675382400,
                y: 23454.41
            },
            {
                x: 1675468800,
                y: 23440.09
            },
            {
                x: 1675555200,
                y: 23328.24
            },
            {
                x: 1675641600,
                y: 22936.95
            },
            {
                x: 1675728000,
                y: 22763.74
            },
            {
                x: 1675814400,
                y: 23254.79
            },
            {
                x: 1675900800,
                y: 22964.87
            },
            {
                x: 1675987200,
                y: 21794.05
            },
            {
                x: 1676073600,
                y: 21638.55
            },
            {
                x: 1676160000,
                y: 21861.84
            },
            {
                x: 1676246400,
                y: 21787.25
            },
            {
                x: 1676332800,
                y: 21787.99
            },
            {
                x: 1676419200,
                y: 22211.8
            },
            {
                x: 1676505600,
                y: 24340.73
            },
            {
                x: 1676592000,
                y: 23544.67
            },
            {
                x: 1676678400,
                y: 24572.97
            },
            {
                x: 1676764800,
                y: 24641.94
            },
            {
                x: 1676851200,
                y: 24290.18
            },
            {
                x: 1676937600,
                y: 24834.81
            },
            {
                x: 1677024000,
                y: 24438.1
            },
            {
                x: 1677110400,
                y: 24185.67
            },
            {
                x: 1677196800,
                y: 23946.39
            },
            {
                x: 1677283200,
                y: 23192.02
            },
            {
                x: 1677369600,
                y: 23176.76
            },
            {
                x: 1677456000,
                y: 23563.11
            },
            {
                x: 1677542400,
                y: 23497.62
            },
            {
                x: 1677628800,
                y: 23128.3
            },
            {
                x: 1677715200,
                y: 23641.68
            },
            {
                x: 1677801600,
                y: 23467.36
            },
            {
                x: 1677888000,
                y: 22351.72
            },
            {
                x: 1677974400,
                y: 22348.51
            },
            {
                x: 1678060800,
                y: 22427.56
            },
            {
                x: 1678147200,
                y: 22410.62
            },
            {
                x: 1678233600,
                y: 22197.49
            },
            {
                x: 1678320000,
                y: 21698.33
            },
            {
                x: 1678406400,
                y: 20363.36
            },
            {
                x: 1678492800,
                y: 20224.85
            },
            {
                x: 1678579200,
                y: 20656.78
            },
            {
                x: 1678665600,
                y: 22205.32
            },
            {
                x: 1678752000,
                y: 24213.74
            },
            {
                x: 1678838400,
                y: 24767.46
            },
            {
                x: 1678924800,
                y: 24376.39
            },
            {
                x: 1679011200,
                y: 25053.64
            },
            {
                x: 1679097600,
                y: 27462.77
            },
            {
                x: 1679184000,
                y: 26975.39
            },
            {
                x: 1679270400,
                y: 28045.84
            },
            {
                x: 1679356800,
                y: 27790.89
            },
            {
                x: 1679443200,
                y: 28191.53
            },
            {
                x: 1679529600,
                y: 27306.32
            },
            {
                x: 1679616000,
                y: 28332.42
            },
            {
                x: 1679702400,
                y: 27496.2
            },
            {
                x: 1679788800,
                y: 27496.06
            },
            {
                x: 1679875200,
                y: 27999.84
            },
            {
                x: 1679961600,
                y: 27141.23
            },
            {
                x: 1680048000,
                y: 27274.72
            },
            {
                x: 1680134400,
                y: 28355.92
            },
            {
                x: 1680220800,
                y: 28033.06
            },
            {
                x: 1680307200,
                y: 28479.75
            },
            {
                x: 1680393600,
                y: 28465.04
            },
            {
                x: 1680480000,
                y: 28185.2
            },
            {
                x: 1680566400,
                y: 27802.23
            },
            {
                x: 1680652800,
                y: 28169.5
            },
            {
                x: 1680739200,
                y: 28180.4
            },
            {
                x: 1680825600,
                y: 28039.94
            },
            {
                x: 1680912000,
                y: 27925.55
            },
            {
                x: 1680998400,
                y: 27956.01
            },
            {
                x: 1681084800,
                y: 28336.18
            },
            {
                x: 1681171200,
                y: 29656.24
            },
            {
                x: 1681257600,
                y: 30234.98
            },
            {
                x: 1681344000,
                y: 29899.24
            },
            {
                x: 1681430400,
                y: 30407.6
            },
            {
                x: 1681516800,
                y: 30486.05
            },
            {
                x: 1681603200,
                y: 30319.32
            },
            {
                x: 1681689600,
                y: 30315.39
            },
            {
                x: 1681776000,
                y: 29447.1
            },
            {
                x: 1681862400,
                y: 30393.64
            },
            {
                x: 1681948800,
                y: 28829.57
            },
            {
                x: 1682035200,
                y: 28243.02
            },
            {
                x: 1682121600,
                y: 27267.99
            },
            {
                x: 1682208000,
                y: 27816.18
            },
            {
                x: 1682294400,
                y: 27590.55
            },
            {
                x: 1682380800,
                y: 27516.48
            },
            {
                x: 1682467200,
                y: 28301.71
            },
            {
                x: 1682553600,
                y: 28429.72
            },
            {
                x: 1682640000,
                y: 29480.35
            },
            {
                x: 1682726400,
                y: 29329.63
            },
            {
                x: 1682812800,
                y: 29244.68
            },
            {
                x: 1682899200,
                y: 29264.14
            },
            {
                x: 1682985600,
                y: 28086.65
            },
            {
                x: 1683072000,
                y: 28678.29
            },
            {
                x: 1683158400,
                y: 29007.66
            },
            {
                x: 1683244800,
                y: 28851.84
            },
            {
                x: 1683331200,
                y: 29535.38
            },
            {
                x: 1683417600,
                y: 28903.41
            },
            {
                x: 1683504000,
                y: 28456.84
            },
            {
                x: 1683590400,
                y: 27691.41
            },
            {
                x: 1683676800,
                y: 27640.09
            },
            {
                x: 1683763200,
                y: 27617.14
            },
            {
                x: 1683849600,
                y: 26993.2
            },
            {
                x: 1683936000,
                y: 26803.05
            },
            {
                x: 1684022400,
                y: 26785.94
            },
            {
                x: 1684108800,
                y: 26926.17
            },
            {
                x: 1684195200,
                y: 27191.97
            },
            {
                x: 1684281600,
                y: 27036.39
            },
            {
                x: 1684368000,
                y: 27398.27
            },
            {
                x: 1684454400,
                y: 26833.27
            },
            {
                x: 1684540800,
                y: 26889.6
            },
            {
                x: 1684627200,
                y: 27124.48
            },
            {
                x: 1684713600,
                y: 26756.57
            },
            {
                x: 1684800000,
                y: 26849.97
            },
            {
                x: 1684886400,
                y: 27223.19
            },
            {
                x: 1684972800,
                y: 26327.38
            },
            {
                x: 1685059200,
                y: 26477.29
            },
            {
                x: 1685145600,
                y: 26719.74
            },
            {
                x: 1685232000,
                y: 26873.18
            },
            {
                x: 1685318400,
                y: 28082.7
            },
            {
                x: 1685404800,
                y: 27744.66
            },
            {
                x: 1685491200,
                y: 27704
            },
            {
                x: 1685577600,
                y: 27213.71
            },
            {
                x: 1685664000,
                y: 26814.77
            },
            {
                x: 1685750400,
                y: 27251.93
            },
            {
                x: 1685836800,
                y: 27073.27
            },
            {
                x: 1685923200,
                y: 27125.02
            },
            {
                x: 1686009600,
                y: 25747.2
            },
            {
                x: 1686096000,
                y: 27243.64
            },
            {
                x: 1686182400,
                y: 26352.2
            },
            {
                x: 1686268800,
                y: 26507.33
            },
            {
                x: 1686355200,
                y: 26483.52
            },
            {
                x: 1686441600,
                y: 25852.82
            },
            {
                x: 1686528000,
                y: 25933.06
            },
            {
                x: 1686614400,
                y: 25904.32
            },
            {
                x: 1686700800,
                y: 25921.42
            },
            {
                x: 1686787200,
                y: 25127.04
            },
            {
                x: 1686873600,
                y: 25575.69
            },
            {
                x: 1686960000,
                y: 26326.23
            },
            {
                x: 1687046400,
                y: 26509.82
            },
            {
                x: 1687132800,
                y: 26337.08
            },
            {
                x: 1687219200,
                y: 26848.8
            },
            {
                x: 1687305600,
                y: 28326.8
            },
            {
                x: 1687392000,
                y: 29992.98
            }
        ]
    }
}

async function getAvgBlockSize() {
    // const res = await axios.get('https://api.blockchain.info/charts/avg-block-size?timespan=5months&format=json&cors=true')
    // return res.data
    return {
        status: "ok",
        name: "Average Block Size",
        unit: "MB",
        period: "day",
        description: "The average block size in MB.",
        values: [
            {
                x: 1674432000,
                y: 1.1005096139240504
            },
            {
                x: 1674518400,
                y: 1.3420454263565889
            },
            {
                x: 1674604800,
                y: 1.0009242571428576
            },
            {
                x: 1674691200,
                y: 1.1061077999999993
            },
            {
                x: 1674777600,
                y: 1.1416405779220786
            },
            {
                x: 1674864000,
                y: 0.9601554166666668
            },
            {
                x: 1674950400,
                y: 0.9890340559006203
            },
            {
                x: 1675036800,
                y: 1.331806333333333
            },
            {
                x: 1675123200,
                y: 1.5394536000000008
            },
            {
                x: 1675209600,
                y: 1.5758903795620436
            },
            {
                x: 1675296000,
                y: 1.4260836068965514
            },
            {
                x: 1675382400,
                y: 1.4617055563909778
            },
            {
                x: 1675468800,
                y: 1.7588637720588232
            },
            {
                x: 1675555200,
                y: 1.6290970592105256
            },
            {
                x: 1675641600,
                y: 2.203473168918918
            },
            {
                x: 1675728000,
                y: 2.142792676056337
            },
            {
                x: 1675814400,
                y: 2.108701760869565
            },
            {
                x: 1675900800,
                y: 2.1439365370370354
            },
            {
                x: 1675987200,
                y: 2.0646328843537427
            },
            {
                x: 1676073600,
                y: 2.3520763892617444
            },
            {
                x: 1676160000,
                y: 2.5247853664596285
            },
            {
                x: 1676246400,
                y: 2.162067403846153
            },
            {
                x: 1676332800,
                y: 2.3363439740259726
            },
            {
                x: 1676419200,
                y: 2.19020936196319
            },
            {
                x: 1676505600,
                y: 2.10664605027933
            },
            {
                x: 1676592000,
                y: 2.048259181818183
            },
            {
                x: 1676678400,
                y: 2.1140637500000006
            },
            {
                x: 1676764800,
                y: 2.2633263580246914
            },
            {
                x: 1676851200,
                y: 2.14595393877551
            },
            {
                x: 1676937600,
                y: 2.0447599341317373
            },
            {
                x: 1677024000,
                y: 1.8940469357142848
            },
            {
                x: 1677110400,
                y: 2.0143520760233917
            },
            {
                x: 1677196800,
                y: 1.8418406740740745
            },
            {
                x: 1677283200,
                y: 1.8469322429906543
            },
            {
                x: 1677369600,
                y: 2.0821476726190475
            },
            {
                x: 1677456000,
                y: 1.633578385714286
            },
            {
                x: 1677542400,
                y: 1.8567157956204379
            },
            {
                x: 1677628800,
                y: 2.1105205823529407
            },
            {
                x: 1677715200,
                y: 2.0244970972222234
            },
            {
                x: 1677801600,
                y: 2.0046007559523806
            },
            {
                x: 1677888000,
                y: 2.1456095197368406
            },
            {
                x: 1677974400,
                y: 1.9336509612903225
            },
            {
                x: 1678060800,
                y: 1.8099567272727275
            },
            {
                x: 1678147200,
                y: 2.018768618181817
            },
            {
                x: 1678233600,
                y: 1.9805633082706766
            },
            {
                x: 1678320000,
                y: 1.825581814814815
            },
            {
                x: 1678406400,
                y: 1.8360665294117648
            },
            {
                x: 1678492800,
                y: 2.271631206060606
            },
            {
                x: 1678579200,
                y: 2.3566546397515524
            },
            {
                x: 1678665600,
                y: 2.0660502038216557
            },
            {
                x: 1678752000,
                y: 1.8130728219178092
            },
            {
                x: 1678838400,
                y: 1.952574421768707
            },
            {
                x: 1678924800,
                y: 1.985878835820895
            },
            {
                x: 1679011200,
                y: 1.9005259047619045
            },
            {
                x: 1679097600,
                y: 2.2621394320987656
            },
            {
                x: 1679184000,
                y: 2.320146466216215
            },
            {
                x: 1679270400,
                y: 2.0032644545454543
            },
            {
                x: 1679356800,
                y: 1.9889303517241388
            },
            {
                x: 1679443200,
                y: 2.161154075471699
            },
            {
                x: 1679529600,
                y: 2.4930217049180334
            },
            {
                x: 1679616000,
                y: 2.4300912283950598
            },
            {
                x: 1679702400,
                y: 2.090348034482757
            },
            {
                x: 1679788800,
                y: 2.2801207083333335
            },
            {
                x: 1679875200,
                y: 1.882243087837836
            },
            {
                x: 1679961600,
                y: 1.8151441417910448
            },
            {
                x: 1680048000,
                y: 2.014914578231293
            },
            {
                x: 1680134400,
                y: 2.052353406451612
            },
            {
                x: 1680220800,
                y: 1.7939797801418438
            },
            {
                x: 1680307200,
                y: 1.8131560857142859
            },
            {
                x: 1680393600,
                y: 1.8760888859060403
            },
            {
                x: 1680480000,
                y: 1.7378229923664124
            },
            {
                x: 1680566400,
                y: 1.7823777839506174
            },
            {
                x: 1680652800,
                y: 1.829118741007194
            },
            {
                x: 1680739200,
                y: 1.9575785124999996
            },
            {
                x: 1680825600,
                y: 1.8807727323943666
            },
            {
                x: 1680912000,
                y: 2.2177743945578237
            },
            {
                x: 1680998400,
                y: 1.984282883561644
            },
            {
                x: 1681084800,
                y: 1.6222206178861787
            },
            {
                x: 1681171200,
                y: 1.666888201298702
            },
            {
                x: 1681257600,
                y: 1.9372407937500007
            },
            {
                x: 1681344000,
                y: 1.7926685140845071
            },
            {
                x: 1681430400,
                y: 1.7771835642857152
            },
            {
                x: 1681516800,
                y: 1.8359778797468347
            },
            {
                x: 1681603200,
                y: 1.870822879032258
            },
            {
                x: 1681689600,
                y: 1.7898713096774204
            },
            {
                x: 1681776000,
                y: 1.7747481987951808
            },
            {
                x: 1681862400,
                y: 1.7893579136690647
            },
            {
                x: 1681948800,
                y: 1.6836805037593987
            },
            {
                x: 1682035200,
                y: 1.7731894965517234
            },
            {
                x: 1682121600,
                y: 1.6861164899328858
            },
            {
                x: 1682208000,
                y: 1.60178400680272
            },
            {
                x: 1682294400,
                y: 1.7155766737588656
            },
            {
                x: 1682380800,
                y: 1.5970774639999998
            },
            {
                x: 1682467200,
                y: 1.6074717538461532
            },
            {
                x: 1682553600,
                y: 1.5591510153846153
            },
            {
                x: 1682640000,
                y: 1.6086380816326533
            },
            {
                x: 1682726400,
                y: 1.6043195547445264
            },
            {
                x: 1682812800,
                y: 1.6470233513513513
            },
            {
                x: 1682899200,
                y: 1.664010846153844
            },
            {
                x: 1682985600,
                y: 1.6445938527131787
            },
            {
                x: 1683072000,
                y: 1.5979772624113475
            },
            {
                x: 1683158400,
                y: 1.5963185958904111
            },
            {
                x: 1683244800,
                y: 1.6049264201680673
            },
            {
                x: 1683331200,
                y: 1.6663023355704705
            },
            {
                x: 1683417600,
                y: 1.684206985611511
            },
            {
                x: 1683504000,
                y: 1.7029231678832117
            },
            {
                x: 1683590400,
                y: 1.6603578741721854
            },
            {
                x: 1683676800,
                y: 1.6815469647058818
            },
            {
                x: 1683763200,
                y: 1.7373991986754969
            },
            {
                x: 1683849600,
                y: 1.670210177304964
            },
            {
                x: 1683936000,
                y: 1.7068472275862074
            },
            {
                x: 1684022400,
                y: 1.7191322068965509
            },
            {
                x: 1684108800,
                y: 1.7510377210884351
            },
            {
                x: 1684195200,
                y: 1.7140523071895428
            },
            {
                x: 1684281600,
                y: 1.6729892187499995
            },
            {
                x: 1684368000,
                y: 1.6425040425531916
            },
            {
                x: 1684454400,
                y: 1.726897640000001
            },
            {
                x: 1684540800,
                y: 1.7098359465648862
            },
            {
                x: 1684627200,
                y: 1.8497955364238414
            },
            {
                x: 1684713600,
                y: 1.7075164375000005
            },
            {
                x: 1684800000,
                y: 1.7933465389610392
            },
            {
                x: 1684886400,
                y: 1.793709716312056
            },
            {
                x: 1684972800,
                y: 1.7179078940397354
            },
            {
                x: 1685059200,
                y: 1.6705831176470591
            },
            {
                x: 1685145600,
                y: 1.7947091999999993
            },
            {
                x: 1685232000,
                y: 1.6966330125000013
            },
            {
                x: 1685318400,
                y: 1.7246017716049376
            },
            {
                x: 1685404800,
                y: 1.6985022987012985
            },
            {
                x: 1685491200,
                y: 1.6807613475177312
            },
            {
                x: 1685577600,
                y: 1.5992807727272726
            },
            {
                x: 1685664000,
                y: 1.6381681219512185
            },
            {
                x: 1685750400,
                y: 1.6878379307692308
            },
            {
                x: 1685836800,
                y: 1.7965940270270262
            },
            {
                x: 1685923200,
                y: 1.5976245144927539
            },
            {
                x: 1686009600,
                y: 1.6920342052980135
            },
            {
                x: 1686096000,
                y: 1.6216797629629638
            },
            {
                x: 1686182400,
                y: 1.693495032467532
            },
            {
                x: 1686268800,
                y: 1.630917828402367
            },
            {
                x: 1686355200,
                y: 1.89774127922078
            },
            {
                x: 1686441600,
                y: 1.9986540490797544
            },
            {
                x: 1686528000,
                y: 1.696170649681529
            },
            {
                x: 1686614400,
                y: 1.7981825986394564
            },
            {
                x: 1686700800,
                y: 1.6150911157024792
            },
            {
                x: 1686787200,
                y: 1.7736605067567557
            },
            {
                x: 1686873600,
                y: 1.6543600522875823
            },
            {
                x: 1686960000,
                y: 1.7132291142857154
            },
            {
                x: 1687046400,
                y: 1.9841850860927166
            },
            {
                x: 1687132800,
                y: 1.766902063380282
            },
            {
                x: 1687219200,
                y: 1.6814601691176472
            },
            {
                x: 1687305600,
                y: 1.608081892561983
            }
        ]
    }
}


async function getRateMap(func) {
    const { values } = await func()
    const timestamps = values.map(timestamp => {
        const date = new Date(timestamp.x * 1000)
        return date.toLocaleDateString()
    })
    const rateValues = values.map(value => value.y)
    return {
        timestamps,
        rateValues
    }
}

async function getDataFromAPI(url) {
    const res = await axios.get(url)
    return res.data
}